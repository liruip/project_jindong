<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
</head>
<body>
        用户名：<input id="username" name="username" type="text" ><span></span><br>
        密码：<input id="userps" name="userpass" type="text"><br>
        再次输入密码: <input type="text"><br>
        <button>登录</button>
        <span id="sp"></span>
</body>
</html>
<script>
    var uservalue = document.querySelector("#username");
    var userps = document.querySelector("#userps");
    var btn = document.querySelector("button");
    var sp = document.querySelector("#sp")
    btn.addEventListener("click", function(){
        //创建对象
        var request = new XMLHttpRequest();
        //设置请求参数
        request.open("post", "get_post.php", true);
        //设置回调函数
        request.onreadystatechange = function() {
            if (request.readyState == 4 && request.status == 200) {
                if (request.responseText == "-1") {
                    sp.innerHTML = "用户名已被注册请重新注册";
                }else if (request.responseText == "0"){
                    sp.innerHTML = "注册失败";
                }else if(request.responseText == "1" ){
                    sp.innerHTML = "注册成功";
                }
            }
        }
        //发送请求
        //1）设置请求头
        request.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
        let sendstr = `username=${uservalue.value}&userpass=${userps.value}`;
        request.send(sendstr);
    });




    uservalue.addEventListener("blur", function(){
        //创建对象
        var requests = new XMLHttpRequest();
        //设置请求参数
        requests.open("get", "userSign.php?username="+this.value,true);
        //设置回调函数
        requests.onreadystatechange = ()=> {
            if (requests.readyState == 4 && requests.status == 200) {
                if( requests.responseText == 1) {
                    this.nextElementSibling.style.color = "red";
                    this.nextElementSibling.innerHTML = "用户名已被注册,请重新输入";
                }else{
                    this.nextElementSibling.style.color = "blue";
                    this.nextElementSibling.innerHTML = "立即注册";
                }
             
            }
        }
        requests.send();
    })
</script>